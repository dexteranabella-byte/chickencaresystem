<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reports | ChickCare Dashboard</title>
  <!-- Main CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <!-- Boxicons -->
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
</head>
<body>
  <div class="container">
    
    <!-- ======= Sidebar Navigation (Logic) ======= -->
    <!-- This now checks the user's role and shows the correct sidebar -->
    
    {% if session.role == 'admin' or session.role == 'superadmin' %}
    <!-- ADMIN SIDEBAR -->
    <div class="navigation">
      <ul>
        <li>
          <a href="{{ url_for('dashboard') }}">
            <span class="icon"><i class='bx bxs-chicken'></i></span>
            <span class="title">ChickCare</span>
          </a>
        </li>
        <li>
          <a href="{{ url_for('admin_dashboard') }}">
            <span class="icon"><i class='bx bxs-dashboard'></i></span>
            <span class="title">Admin Dashboard</span>
          </a>
        </li>
        <li>
          <a href="{{ url_for('manage_users') }}">
            <span class="icon"><i class='bx bx-user'></i></span>
            <span class="title">Manage Users</span>
          </a>
        </li>
        <li class="active">
          <a href="{{ url_for('report') }}">
            <span class="icon"><i class='bx bx-file'></i></span>
            <span class="title">Reports</span>
          </a>
        </li>
        <li>
          <a href="{{ url_for('logout') }}">
            <span class="icon"><i class='bx bx-log-out'></i></span>
            <span class="title">Logout</span>
          </a>
        </li>
      </ul>
    </div>
    
    {% else %}
    <!-- USER SIDEBAR -->
    <div class="navigation">
      <ul>
        <li>
          <a href="{{ url_for('dashboard') }}">
            <span class="icon"><i class='bx bxs-chicken'></i></span>
            <span class="title">ChickCare</span>
          </a>
        </li>
        <li><a href="{{ url_for('dashboard') }}"><i class='bx bx-grid-alt'></i><span class="title">Dashboard</span></a></li>
        <li><a href="{{ url_for('webcam') }}"><i class='bx bx-line-chart'></i><span class="title">Growth</span></a></li>
        <li><a href="{{ url_for('environment') }}"><i class='bx bx-leaf'></i><span class="title">Environment</span></a></li>
        <li><a href="{{ url_for('feeding') }}"><i class='bx bx-bowl-hot'></i><span class="title">Feeding</span></a></li>
        <li><a href="{{ url_for('sanitization') }}"><i class='bx bx-droplet'></i><span class="title">Sanitization</span></a></li>
        <li class="active"><a href="{{ url_for('report') }}"><i class='bx bx-file'></i><span class="title">Report</span></a></li>
        <li><a href="{{ url_for('logout') }}"><i class='bx bx-log-out'></i><span class="title">Logout</span></a></li>
      </ul>
    </div>
    {% endif %}
    <!-- ======= End Sidebar Navigation ======= -->
    
    
    <!-- ======= Main Content ======= -->
    <div class="main">
      
      <!-- ======= Top Bar (Logic) ======= -->
      {% if session.role == 'admin' or session.role == 'superadmin' %}
      <!-- ADMIN TOPBAR -->
      <div class="topbar">
        <div class="toggle"><i class='bx bx-menu'></i></div>
        <div class="title">Reports</div>
      </div>
      {% else %}
      <!-- USER TOPBAR -->
      <div class="topbar">
        <div class="toggle"><i class='bx bx-menu'></i></div>
        <div class="search">
          <label>
            <input type="text" placeholder="Search here">
            <i class='bx bx-search'></i>
          </label>
        </div>
        <div class="user">
          <img src="{{ url_for('static', filename='imgs/admin.jpg') }}" alt="User"> <!-- Assuming user img is admin.jpg -->
        </div>
      </div>
      {% endif %}
      <!-- ======= End Top Bar ======= -->

      <!-- ======= Reports Table (Logic) ======= -->
      <div class="details">
        <div class="recentOrders">
          
          {% if session.role == 'admin' or session.role == 'superadmin' %}
          <!-- ADMIN REPORT -->
          <div class="cardHeader">
            <h2>Recent System Activity</h2>
            <a href="#" class="btn">Generate Report</a>
          </div>
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Temperature</th>
                <th>Humidity</th>
                <th>Ammonia</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <!-- This data comes from the app.py /report route -->
              {% for activity in recent_activity %}
              <tr>
                <td>{{ activity.datetime.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>{{ activity.temperature }} Â°C</td>
                <td>{{ activity.humidity }} %</td>
                <td>{{ activity.ammonia }} ppm</td>
                <td><span class="status delivered">Logged</span></td>
              </tr>
              {% else %}
              <tr>
                <td colspan="5">No recent activity found.</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          
          {% else %}
          <!-- USER REPORT -->
          <div class="cardHeader">
            <h2>System Reports</h2>
            <a href="#" class="btn">Generate Report</a>
          </div>
          <table>
            <thead>
              <tr>
                <th>Report ID</th>
                <th>Date</th>
                <th>Type</th>
                <th>Status</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <!-- This is the static table for regular users -->
              <tr>
                <td>#RPT-001</td>
                <td>2025-11-05</td>
                <td>Growth Data</td>
                <td><span class="status delivered">Completed</span></td>
                <td><a href="#">View</a></td>
              </tr>
              <tr>
                <td>#RPT-002</td>
                <td>2025-11-04</td>
                <td>Environment</td>
                <td><span class="status pending">Processing</span></td>
                <td><a href="#">View</a></td>
              </tr>
              <tr>
                <td>#RPT-003</td>
                <td>2025-11-02</td>
                <td>Feeding</td>
                <td><span class="status return">Failed</span></td>
                <td><a href="#">View</a></td>
              </tr>
            </tbody>
          </table>
          {% endif %}
          
        </div>
      </div>
    </div>
  </div>
  <!-- Main JS -->
  <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
